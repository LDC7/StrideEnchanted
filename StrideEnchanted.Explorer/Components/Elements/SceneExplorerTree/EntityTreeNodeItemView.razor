@using Microsoft.AspNetCore.Components.Web
@using MudBlazor
@using StrideEnchanted.Explorer.Interfaces

<MudTreeViewItem id="@this.Entity.Id"
                 Value="@this.Entity"
                 Text="@this.Entity.Name"
                 IconColor="@Color.Primary"
                 Icon="@Icons.Material.Filled.Label"
                 Selected="@(this.Selected == (object)this.Entity)"
                 OnClick="@this.HandleClick">
  @foreach (var childEntity in this.Entity.Children)
  {
    <EntityTreeNodeItemView Entity="@childEntity" Selected="@this.Selected" SelectedChanged="@this.SelectedChanged" />
  }
</MudTreeViewItem>

@code {
  [Parameter]
  [EditorRequired]
  public required ITrackedEntity Entity { get; set; } = default!;

  [Parameter]
  [EditorRequired]
  public object? Selected { get; set; }

  [Parameter]
  public EventCallback<object?> SelectedChanged { get; set; }

  private Task HandleClick(MouseEventArgs args)
  {
    return this.SelectedChanged.InvokeAsync(this.Entity);
  }
}
